# 一、加入心跳机制
- 1. 目前的ChatServer退出时捕获的SIGINT, SIGTERM，但有时候我是直接关闭直接关闭控制台窗口，发送的是SIGBREAK（在Windows上）或SIGHUP（在Unix-like系统上）信号，这些信号没有被处理，所以程序无法正常清理。但是加了之后依然无法处理，但信号处理可能没有足够的时间来执行清理操作，或者在某些情况下信号处理不完整。导致无法在Redis里标识服务器“及时下线”，由于ChatServer启动时会将Redis里自己的Logincount置为0，所以不及时下线的化，新的客户端就可能收到StatusServer返回的已经不在线的ChatServer的Ip地址。这样就出大问题，包括客户端与服务器之间增加心跳机制，清除僵尸连接等是很有必要的。